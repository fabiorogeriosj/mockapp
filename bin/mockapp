#!/usr/bin/env node

var colors = require('colors');
var fs = require('fs');
var request = require('request');
var _PACKAGEJSONREPO = 'https://raw.githubusercontent.com/fabiorogeriosj/mockapp/master/package.json';
var packageJson = JSON.parse(fs.readFileSync(__dirname+'/../package.json', 'utf8'));

(function mockapp() {


	var showIntro = function (){

		console.log("");
		console.log("   _______             _                       ");
		console.log("  (_______)           | |                      ");
		console.log("   _  _  _  ___   ____| |  _ _____ ____  ____  ");
		console.log("  | ||_|| |/ _ \\ / ___) |_/ |____ |  _ \\|  _ \\ ");
		console.log("  | |   | | |_| ( (___|  _ (/ ___ | |_| | |_| |");
		console.log("  |_|   |_|\\___/ \\____)_| \\_)_____|  __/|  __/ ");
		console.log("                                  |_|   |_|    ");
		console.log("\n_______________________________________________\n".cyan);
		console.log("  Version instaled: ", packageJson.version);
		console.log("_______________________________________________\n".cyan);
		checkNewVersion();
	}

	var checkNewVersion = function(){
		request(_PACKAGEJSONREPO, function (error, response, body) {
		  if (!error && response.statusCode == 200) {
		    var packageJsonRepo = JSON.parse(body);
				if(packageJsonRepo.version >= packageJson.version){
					console.log("                                               ".bgYellow.black);
					console.log("  Hey bro, there is a new version: ".bgYellow.black + packageJson.version.bgYellow.black + "       ".bgYellow.black);
					console.log("                                               ".bgYellow.black);
					console.log("  No panic, just update mockapp:            ".bgYellow.black);
					console.log("  npm install mockapp -g                    ".bgYellow.black);
					console.log("                                               ".bgYellow.black);
				}
		  }
		})
	}

	showIntro();

})();
